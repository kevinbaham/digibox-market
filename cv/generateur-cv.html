<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>G√©n√©rateur de CV - DigiBox Market</title>
  <link rel="stylesheet" href="../style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f1f5f9;
      padding: 30px;
    }
    .container {
      display: flex;
      gap: 40px;
      flex-wrap: wrap;
    }
    .form-section, .preview-section {
      flex: 1;
      min-width: 300px;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      background: #2563eb;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }
    .cv-box h2, .cv-box p, .cv-box ul {
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h1>üìÑ G√©n√©rateur de CV Professionnel</h1>
  <div class="container">
    <div class="form-section">
      <h2>Informations</h2>
      <input type="text" id="prenom" placeholder="Pr√©nom">
      <input type="text" id="nom" placeholder="Nom">
      <input type="email" id="email" placeholder="Email">
      <input type="text" id="telephone" placeholder="T√©l√©phone">
      <textarea id="objectif" placeholder="Objectif professionnel"></textarea>
      <textarea id="experience" placeholder="Exp√©riences professionnelles"></textarea>
      <textarea id="diplomes" placeholder="Dipl√¥mes et formations"></textarea>
      <textarea id="competences" placeholder="Comp√©tences (s√©par√©es par des virgules)"></textarea>
      <textarea id="langues" placeholder="Langues"></textarea>
      <textarea id="reseaux" placeholder="R√©seaux sociaux (LinkedIn, GitHub, etc.)"></textarea>
      <label for="template">Choisir un mod√®le :</label>
      <select id="template">
        <option value="moderne">Moderne</option>
        <option value="classique">Classique</option>
        <option value="creatif">Cr√©atif</option>
      </select>
      <button onclick="previewCV()">Voir le CV</button>
      <button onclick="generatePDF()" style="margin-top:10px; background:#16a34a;">T√©l√©charger CV PDF</button>
    </div>

    <div class="preview-section">
      <h2>Pr√©visualisation</h2>
      <div id="cv-preview" class="cv-box" style="padding:10px; background:#fff;">
        <p>Remplissez le formulaire pour g√©n√©rer votre CV.</p>
      </div>
    </div>
  </div>

  <script>
    if (!localStorage.getItem('digibox_user')) {
      alert("Veuillez vous connecter pour acc√©der au g√©n√©rateur.");
      window.location.href = "../login.html";
    }

    function previewCV() {
      const cv = document.getElementById('cv-preview');
      const prenom = document.getElementById('prenom').value;
      const nom = document.getElementById('nom').value;
      const email = document.getElementById('email').value;
      const tel = document.getElementById('telephone').value;
      const objectif = document.getElementById('objectif').value;
      const exp = document.getElementById('experience').value;
      const dipl = document.getElementById('diplomes').value;
      const comp = document.getElementById('competences').value.split(',');
      const langues = document.getElementById('langues').value;
      const reseaux = document.getElementById('reseaux').value;
      const model = document.getElementById('template').value;

      // Vous pouvez charger dynamiquement diff√©rents mod√®les plus tard ici
      cv.innerHTML = `
        <h2>${prenom} ${nom}</h2>
        <p><strong>Email :</strong> ${email}</p>
        <p><strong>T√©l√©phone :</strong> ${tel}</p>
        <h3>Objectif professionnel</h3>
        <p>${objectif}</p>
        <h3>Exp√©riences</h3>
        <p>${exp}</p>
        <h3>Dipl√¥mes</h3>
        <p>${dipl}</p>
        <h3>Comp√©tences</h3>
        <ul>${comp.map(c => `<li>${c.trim()}</li>`).join('')}</ul>
        <h3>Langues</h3>
        <p>${langues}</p>
        <h3>R√©seaux</h3>
        <p>${reseaux}</p>
        <p><strong>Mod√®le choisi :</strong> ${model}</p>
      `;
    }

    function generatePDF() {
      if (!localStorage.getItem("digibox_paid")) {
        alert("Merci d'effectuer le paiement avant de t√©l√©charger.");
        window.location.href = "../paiement.html";
        return;
      }
      const element = document.getElementById('cv-preview');
      html2pdf().from(element).save('CV.pdf');
    }
  </script>
</body>
</html>
